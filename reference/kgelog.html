<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Log-transformed Modified Kling-Gupta Efficiency — kgelog • tidyhydro</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Inter_Tight-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Log-transformed Modified Kling-Gupta Efficiency — kgelog"><meta name="description" content="Calculate the modified Kling-Gupta Efficiency (Kling et al., 2012) on
log-transformed data as proposed in Mai (2023),
namely \(KGE_{log}\), \(KGE_{logQ_{low}}\) and \(KGE_{logQ_{hi}}\).
All are dimensionless (from \(-\infty\) to 1).
This metric is recommended for emphasising low flows. By transforming the
discharge data logarithmically, it gives more weight to smaller flow
values, which is important for understanding drought conditions or
baseflow behaviour (see Mai 2023; Mizukami et al., 2019)."><meta property="og:description" content="Calculate the modified Kling-Gupta Efficiency (Kling et al., 2012) on
log-transformed data as proposed in Mai (2023),
namely \(KGE_{log}\), \(KGE_{logQ_{low}}\) and \(KGE_{logQ_{hi}}\).
All are dimensionless (from \(-\infty\) to 1).
This metric is recommended for emphasising low flows. By transforming the
discharge data logarithmically, it gives more weight to smaller flow
values, which is important for understanding drought conditions or
baseflow behaviour (see Mai 2023; Mizukami et al., 2019)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyhydro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidyhydro.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/available_metrics.html">Available metrics</a></li>
    <li><a class="dropdown-item" href="../articles/benchmarks.html">Benchmarks</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/atsyplenkov/tidyhydro" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Log-transformed Modified Kling-Gupta Efficiency</h1>
      <small class="dont-index">Source: <a href="https://github.com/atsyplenkov/tidyhydro/tree/master/R/kge.R" class="external-link"><code>R/kge.R</code></a></small>
      <div class="d-none name"><code>kgelog.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate the modified Kling-Gupta Efficiency (<em>Kling et al., 2012</em>) on
<strong>log-transformed</strong> data as proposed in <em>Mai</em> (2023),
namely \(KGE_{log}\), \(KGE_{logQ_{low}}\) and \(KGE_{logQ_{hi}}\).
All are dimensionless (from \(-\infty\) to 1).</p>
<p>This metric is recommended for emphasising low flows. By transforming the
discharge data logarithmically, it gives more weight to smaller flow
values, which is important for understanding drought conditions or
baseflow behaviour (see <em>Mai 2023</em>; <em>Mizukami et al., 2019</em>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kgelog</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">kgelog</span><span class="op">(</span><span class="va">data</span>, <span class="va">truth</span>, <span class="va">estimate</span>, na_rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kgelog_vec</span><span class="op">(</span><span class="va">truth</span>, <span class="va">estimate</span>, na_rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kgelog_low</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">kgelog_low</span><span class="op">(</span><span class="va">data</span>, <span class="va">truth</span>, <span class="va">estimate</span>, na_rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kgelog_low_vec</span><span class="op">(</span><span class="va">truth</span>, <span class="va">estimate</span>, na_rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kgelog_hi</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">kgelog_hi</span><span class="op">(</span><span class="va">data</span>, <span class="va">truth</span>, <span class="va">estimate</span>, na_rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kgelog_hi_vec</span><span class="op">(</span><span class="va">truth</span>, <span class="va">estimate</span>, na_rm <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> containing the columns specified by the <code>truth</code>
and <code>estimate</code> arguments.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Not currently used.</p></dd>


<dt id="arg-truth">truth<a class="anchor" aria-label="anchor" href="#arg-truth"></a></dt>
<dd><p>The column identifier for the true results
(that is <code>numeric</code>). This should be an unquoted column name although
this argument is passed by expression and supports
<a href="https://rlang.r-lib.org/reference/topic-inject.html" class="external-link">quasiquotation</a> (you can unquote column
names). For <code>_vec()</code> functions, a <code>numeric</code> vector.</p></dd>


<dt id="arg-estimate">estimate<a class="anchor" aria-label="anchor" href="#arg-estimate"></a></dt>
<dd><p>The column identifier for the predicted
results (that is also <code>numeric</code>). As with <code>truth</code> this can be
specified different ways but the primary method is to use an
unquoted variable name. For <code>_vec()</code> functions, a <code>numeric</code> vector.</p></dd>


<dt id="arg-na-rm">na_rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>A <code>logical</code> value indicating whether <code>NA</code>
values should be stripped before the computation proceeds.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>tibble</code> with columns <code>.metric</code>, <code>.estimator</code>,
and <code>.estimate</code> and 1 row of values.</p>
<p>For grouped data frames, the number of rows returned will be the same as
the number of groups.</p>
<p>For <code>kgelog_vec()</code>, a single <code>numeric</code> value (or <code>NA</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>While the <code>kgelog()</code> function proposes the log-transformed version of the
<a href="kge2012.html">kge2012</a>, functions such as <code>kgelog_low()</code> and <code>kgelog_hi()</code>
also perform data subsetting according to conditions specified in
<em>Mai</em> (2023).</p>
<p>The metrics <code>kgelog_low()</code> and <code>kgelog_hi()</code> are then the \(KGE'\)
of the log-transformed observed and simulated streamflow considering
only low-flow and high-flow time steps, respectively.</p>
<p>A data point is considered in the derivation of <code>kgelog_low()</code> if the
observed streamflow (\(\text{obs}\)) for that time step satisfies
the following conditions:</p>
<p>$$
0.0 &lt; \text{obs} \le min(\text{obs}) + 0.05 \times
(max(\text{obs}) - min(\text{obs}))
$$</p>
<p>A data point is considered in the derivation of <code>kgelog_hi()</code> if the
observed streamflow (\(\text{obs}\)) for that time step satisfies
the following conditions:</p>
<p>$$
\text{obs} &gt; min(\text{obs}) + 0.05 \times
(max(\text{obs}) - min(\text{obs}))
$$</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Please note that the decision if a time step is a low-flow or high-flow
time step is solely based on the observations which means it is always
the same time steps for a given basin and time period while being
independent of the simulation (<em>Mai</em>, 2023).</p>
<p>Unlike the Nash–Sutcliffe Efficiency (<a href="nse.html">nse</a>), the KGE does not have an
inherent benchmark such as "mean flow", and \(KGE' = 0\) does not
correspond to a baseline performance.
Therefore, \(KGE_{log}\) values should not be interpreted as "good"
or "bad" based solely on their sign or magnitude.
Instead, users are encouraged to examine the individual components
(\(r\), \(\beta\), \(\gamma\))
to understand the nature of model performance and consider defining
explicit benchmarks based on the study context.</p>
<p>For further discussion, see <em>Knoben et al.</em> (2019), who caution against
directly translating NSE-based interpretation thresholds to KGE.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kling, H., Fuchs, M., &amp; Paulin, M. (2012). Runoff conditions in the upper
Danube basin under an ensemble of climate change scenarios.
Journal of Hydrology, 424–425, 264–277.
<a href="https://doi.org/10.1016/j.jhydrol.2012.01.011" class="external-link">doi:10.1016/j.jhydrol.2012.01.011</a></p>
<p>Knoben, W. J. M., Freer, J. E., &amp; Woods, R. A. (2019).
Technical note: Inherent benchmark or not? Comparing Nash–Sutcliffe and
Kling–Gupta efficiency scores. Hydrology and Earth System Sciences, 23,
4323–4331. <a href="https://doi.org/10.5194/hess-23-4323-2019" class="external-link">doi:10.5194/hess-23-4323-2019</a></p>
<p>Mai, J. (2023). Ten strategies towards successful calibration of
environmental models. Journal of Hydrology, 620, 129414.
<a href="https://doi.org/10.1016/j.jhydrol.2023.129414" class="external-link">doi:10.1016/j.jhydrol.2023.129414</a></p>
<p>Mizukami, N., Rakovec, O., Newman, A. J., Clark, M. P., Wood, A. W.,
Gupta, H. V., &amp; Kumar, R. (2019). On the choice of calibration metrics
for “high-flow” estimation using hydrologic models.
Hydrology and Earth System Sciences, 23(6), 2601–2614.
<a href="https://doi.org/10.5194/hess-23-2601-2019" class="external-link">doi:10.5194/hess-23-2601-2019</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other KGE variants:
<code><a href="kge.html">kge</a>()</code>,
<code><a href="kge2012.html">kge2012</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atsyplenkov/tidyhydro" class="external-link">tidyhydro</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Supply truth and predictions as bare column names</span></span></span>
<span class="r-in"><span><span class="fu">kgelog</span><span class="op">(</span><span class="va">avacha</span>, <span class="va">obs</span>, <span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .metric .estimator .estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> kgelog  standard       0.971</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or as numeric vectors</span></span></span>
<span class="r-in"><span><span class="fu">kgelog_vec</span><span class="op">(</span><span class="va">avacha</span><span class="op">$</span><span class="va">obs</span>, <span class="va">avacha</span><span class="op">$</span><span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9707064</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/atsyplenkov" class="external-link">Anatolii Tsyplenkov</a></p>
</div>

<div class="pkgdown-footer-right">
  <p><a href="https://opensource.org/license/mit" class="external-link">MIT</a> License | Copyright (c) 2025 tidyhydro authors</p>
</div>

    </footer></div>





  </body></html>

