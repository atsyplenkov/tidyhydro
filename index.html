<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tidy Metrics for Assessing Hydrological Models Performance • tidyhydro</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="deps/Fira_Code-0.4.10/font.css" rel="stylesheet">
<link href="deps/Inter_Tight-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Tidy Metrics for Assessing Hydrological Models Performance">
<meta name="description" content="Provides tidy tools for comparing simulated and observed hydrological time series. Includes compatibility with the yardstick package for model performance evaluation using commonly used metrics such as the Nash–Sutcliffe Efficiency (NSE), Kling–Gupta Efficiency (KGE), percent bias (pBIAS) and etc.">
<meta property="og:description" content="Provides tidy tools for comparing simulated and observed hydrological time series. Includes compatibility with the yardstick package for model performance evaluation using commonly used metrics such as the Nash–Sutcliffe Efficiency (NSE), Kling–Gupta Efficiency (KGE), percent bias (pBIAS) and etc.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tidyhydro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/tidyhydro.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/benchmarks.html">Benchmarks</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/atsyplenkov/tidyhydro" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tidyhydro">tidyhydro<a class="anchor" aria-label="anchor" href="#tidyhydro"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>The <code>tidyhydro</code> package provides a set of commonly used metrics in hydrology (such as <em>NSE</em>, <em>KGE</em>, <em>pBIAS</em>) for use within a <a href="https://www.tidymodels.org/" class="external-link"><code>tidymodels</code></a> infrastructure. Originally inspired by the <a href="https://github.com/tidymodels/yardstick/tree/main" class="external-link"><code>yardstick</code></a> and <a href="https://github.com/hzambran/hydroGOF" class="external-link"><code>hydroGOF</code></a> packages, this library is mainly written in C++ and provides a very quick estimation of desired goodness-of-fit criteria.</p>
<p>Additionally, you’ll find here a C++ implementation of lesser-known yet powerful metrics used in reports from the United States Geological Survey (USGS) and the National Environmental Monitoring Standards (NEMS) guidelines. Examples include <em>PRESS</em> (Prediction Error Sum of Squares), <em>SFE</em> (Standard Factorial Error), and <em>MSPE</em> (Model Standard Percentage Error) and others. Based on the equations from <em>Helsel et al.</em> (<a href="https://pubs.usgs.gov/publication/tm4A3" class="external-link">2020</a>), <em>Rasmunsen et al.</em> (<a href="https://pubs.usgs.gov/tm/tm3c4/" class="external-link">2008</a>), <em>Hicks et al.</em> (<a href="https://www.nems.org.nz/documents/suspended-sediment" class="external-link">2020</a>) and etc. (see documentation for details).</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>The <code>tidyhydro</code> package follows the philosophy of <a href="https://github.com/tidymodels/yardstick/tree/main" class="external-link"><code>yardstick</code></a> and provides S3 class methods for vectors and data frames. For example, one can estimate <code>NSE</code> and <code>pBIAS</code> for a data frame like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atsyplenkov/tidyhydro" class="external-link">tidyhydro</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">avacha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">avacha</span></span>
<span><span class="co">#&gt; # A data frame: 365 × 3</span></span>
<span><span class="co">#&gt;    date         obs   sim</span></span>
<span><span class="co">#&gt;    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2022-01-01  76.2  84.8</span></span>
<span><span class="co">#&gt;  2 2022-01-02  76.2  84.3</span></span>
<span><span class="co">#&gt;  3 2022-01-03  76.3  84.0</span></span>
<span><span class="co">#&gt;  4 2022-01-04  76.3  83.7</span></span>
<span><span class="co">#&gt;  5 2022-01-05  76.4  83.4</span></span>
<span><span class="co">#&gt;  6 2022-01-06  76.4  83.1</span></span>
<span><span class="co">#&gt;  7 2022-01-07  76.5  83.0</span></span>
<span><span class="co">#&gt;  8 2022-01-08  76.5  82.9</span></span>
<span><span class="co">#&gt;  9 2022-01-09  76.6  82.8</span></span>
<span><span class="co">#&gt; 10 2022-01-10  76.6  82.7</span></span>
<span><span class="co">#&gt; # ℹ 355 more rows</span></span>
<span></span>
<span><span class="fu"><a href="reference/kge.html">kge</a></span><span class="op">(</span><span class="va">avacha</span>, <span class="va">obs</span>, <span class="va">sim</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span><span class="co">#&gt;   .metric .estimator .estimate</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 kge     standard       0.947</span></span></code></pre></div>
<p>or create a <a href="https://yardstick.tidymodels.org/reference/metric_set.html" class="external-link"><code>metric_set</code></a> and estimate several parameters at once like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hydro_metrics</span> <span class="op">&lt;-</span> <span class="fu">yardstick</span><span class="fu">::</span><span class="fu"><a href="https://yardstick.tidymodels.org/reference/metric_set.html" class="external-link">metric_set</a></span><span class="op">(</span><span class="va">nse</span>, <span class="va">pbias</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hydro_metrics</span><span class="op">(</span><span class="va">avacha</span>, <span class="va">obs</span>, <span class="va">sim</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;   .metric .estimator .estimate</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 nse     standard      0.895 </span></span>
<span><span class="co">#&gt; 2 pbias   standard      0.0540</span></span></code></pre></div>
<p>We do understand that sometimes one needs a qualitative interpretation of the model. Therefore, we populated some functions with a <code>performance</code> argument. When <code>performance = TRUE</code>, the metric interpretation will be returned according to Moriasi et al. (<a href="https://elibrary.asabe.org/abstract.asp?aid=46548&amp;t=3&amp;dabs=Y&amp;redir=&amp;redirType=" class="external-link">2015</a>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hydro_metrics</span><span class="op">(</span><span class="va">avacha</span>, <span class="va">obs</span>, <span class="va">sim</span>, performance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;   .metric .estimator .estimate</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;    </span></span>
<span><span class="co">#&gt; 1 nse     standard   Excellent</span></span>
<span><span class="co">#&gt; 2 pbias   standard   Excellent</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>tidyhydro</code> from <a href="https://github.com/atsyplenkov/tidyhydro" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"atsyplenkov/tidyhydro"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="benchmarking">Benchmarking<a class="anchor" aria-label="anchor" href="#benchmarking"></a>
</h2>
<p>Since the package uses <code>Rcpp</code> in the background, it performs slightly faster than base R and other R packages (see <a href="https://atsyplenkov.github.io/tidyhydro/articles/benchmarks.html">benchmarks</a>). This is particularly noticeable with large datasets:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">truth</span>, <span class="va">estimate</span>, <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">#fmt: skip</span></span>
<span>  <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">truth</span> <span class="op">-</span> <span class="va">estimate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span> <span class="op">/</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">truth</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">truth</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="https://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span></span>
<span>  tidyhydro <span class="op">=</span> <span class="fu">tidyhydro</span><span class="fu">::</span><span class="fu"><a href="reference/nse.html">nse_vec</a></span><span class="op">(</span>truth <span class="op">=</span> <span class="va">x</span>, estimate <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,</span>
<span>  hydroGOF <span class="op">=</span> <span class="fu">hydroGOF</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hydroGOF/man/NSE.html" class="external-link">NSE</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">y</span>, obs <span class="op">=</span> <span class="va">x</span><span class="op">)</span>,</span>
<span>  baseR <span class="op">=</span> <span class="fu"><a href="reference/nse.html">nse</a></span><span class="op">(</span>truth <span class="op">=</span> <span class="va">x</span>, estimate <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  relative <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter_gc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">50L</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 6</span></span>
<span><span class="co">#&gt;   expression   min median `itr/sec` mem_alloc `gc/sec`</span></span>
<span><span class="co">#&gt;   &lt;bch:expr&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 tidyhydro    1      1       52.8        NaN      NaN</span></span>
<span><span class="co">#&gt; 2 hydroGOF    30.5   41.1      1          Inf      Inf</span></span>
<span><span class="co">#&gt; 3 baseR       17.3   20.6      2.31       Inf      Inf</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the tidyhydro project is released with a <a href="https://atsyplenkov.github.io/tidyhydro/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<a href="https://github.com/hzambran/hydroGOF" class="external-link"><code>hydroGOF</code></a> - Goodness-of-fit functions for comparison of simulated and observed hydrological time series.</li>
<li>
<a href="https://github.com/tidymodels/yardstick/tree/main" class="external-link"><code>yardstick</code></a> - tidy methods for models performance assessment.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/atsyplenkov/tidyhydro" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/atsyplenkov/tidyhydro/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tidyhydro</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Anatoly Tsyplenkov <br><small class="roles"> Maintainer, author, copyright holder </small> <a href="https://orcid.org/0000-0003-4144-8402" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/atsyplenkov/tidyhydro/releases" class="external-link"> <img src="https://img.shields.io/github/v/release/atsyplenkov/tidyhydro?style=flat&amp;labelColor=1C2C2E&amp;color=198ce7&amp;logo=GitHub&amp;logoColor=white"></a></li>
<li><a href="https://app.codecov.io/gh/atsyplenkov/tidyhydro" class="external-link"> <img src="https://img.shields.io/codecov/c/gh/atsyplenkov/tidyhydro?style=flat&amp;labelColor=1C2C2E&amp;color=256bc0&amp;logo=Codecov&amp;logoColor=white"></a></li>
<li><a href="https://github.com/atsyplenkov/tidyhydro/actions/workflows/check-r-pkg.yaml" class="external-link"> <img src="https://img.shields.io/github/actions/workflow/status/atsyplenkov/tidyhydro/check-r-pkg.yaml?style=flat&amp;labelColor=1C2C2E&amp;color=256bc0&amp;logo=GitHub%20Actions&amp;logoColor=white"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/atsyplenkov" class="external-link">Anatolii Tsyplenkov</a></p>
</div>

<div class="pkgdown-footer-right">
  <p><a href="https://opensource.org/license/mit" class="external-link">MIT</a> License | Copyright (c) 2025 tidyhydro authors</p>
</div>

    </footer>
</div>





  </body>
</html>
